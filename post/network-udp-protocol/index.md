> 本文是对UDP协议的总结笔记。除非另外注明，本文的主要参考为[TCP/IP Illustrated: Volume I: The Protocols](http://www.pcvr.nl/tcpip/)第11和12章。

# **UDP基本特征**

UDP是一个简单的面向数据报的传输层协议，它和TCP有以下显著区别：

1. 它是不可靠的。它发送用户数据，但是不保证它们抵达接收端。它不提供确认、序号、超时重传等机制。它也不能保证抵达接收端时数据报的顺序，是否重复等。
2. 它是无连接的。TCP需要建立连接后才能发送数据，UDP不需要。
3. 它的每个数据报和应用程序是紧密相关的。应用程序每次输出操作会产生唯一一个UDP数据报，并产生唯一一个IP数据报，但是TCP中应用程序写入的数据量和单个IP数据报中发送的内容没有关系。
    应用程序需要考虑链路层的MTU，如果超过了MTU，那么IP数据报会被分段，这适用于从源端到目标端所经过的所有网络。
4. UDP协议支持多播和广播。

<!--more-->

UDP数据报的头部如下：

{{% figure class="center" src="/images/udp-protocol/udp-header.gif" alt="UDP数据报头部" title="UDP数据报头部"  %}}

源端和目标端端口号用于区分发送方应用和接收方应用。因为IP层已经做了解多路复用(demultiplex)操作，即根据IP头部中的协议好区分了TCP和UDP协议，因此TCP报文段头部的端口号和UDP数据报头部的端口号是独立的，也就是说一个UDP协议的端口号绑定应用A，另一个TCP协议的同样的端口绑定应用B是没有关系的。

长度字段表示的是UDP头部加上UDP数据的总长度，单位是字节。长度字段是冗余的，因为IP头部中有IP数据报长度和IP头部长度可以计算出UDP数据报的长度。校验和计算方法和TCP的相似，在TCP协议文章中介绍。


